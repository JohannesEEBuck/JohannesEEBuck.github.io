function DataSetLoader(){this.loaded=!1,this.error=!1,this.xmlDoc=null,this.dataSet=null,this.file="files/BCC_HD.xml",this.onerror=function(t,e){console.error("state="+t.readyState+" status="+t.status+" for file : "+e)},this.onready=function(t,e,a){console.log("state="+e.readyState+" status="+e.status+" for file : "+a)}}function xmlToJson(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var a=0;a<t.attributes.length;a++){var s=t.attributes.item(a);e["@attributes"][s.nodeName]=s.nodeValue}}}else 3==t.nodeType&&(e=t.nodeValue);if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var i=t.childNodes.item(o),n=i.nodeName;if(void 0===e[n])e[n]=xmlToJson(i);else{if(void 0===e[n].push){var r=e[n];e[n]=[],e[n].push(r)}e[n].push(xmlToJson(i))}}return e}function initDataSetInfo(t){for(var e={},a=0;a<t.DataSet.Data.length;a++)initCountryData(t.DataSet.Data[a],e);return e}function initCountryData(t,e){for(var a=t.Country["@attributes"],s=[],o=[],i=["x"],n=[],r=[],h=[],u=[a.code+"_GDP"],l=[a.code.toUpperCase()],d=[],p=[],f=[],x=0;x<t.Observations.Observation.length;x++){for(var D=t.Observations.Observation[x],c=0;c<D.Theta.obs.length;c++)s.push(D.Theta.obs[c]["@attributes"].angle),o.push(D.Theta.obs[c]["@attributes"].date);i.push(D.fullDate["#text"]);var m=null,b=null;D.GDP&&(m=D.GDP["#text"]),u.push(m),D.GDP_GC&&(b=D.GDP_GC["#text"]),l.push(b),n.push([toDate(D.fullDate["#text"]).getTime(),b?Number(b):b]),h.push(h?Number(b):h),r.push(m?Number(m):m);var g=[];if("1"==D.A["#text"]&&(p.push(new Array("A",D.fullDate["#text"])),g.push("A")),"1"==D.B["#text"]&&(p.push(new Array("B",D.fullDate["#text"])),g.push("B")),"1"==D.C["#text"]&&(p.push(new Array("C",D.fullDate["#text"])),g.push("C")),"1"==D.D["#text"]&&(p.push(new Array("D",D.fullDate["#text"])),g.push("D")),"1"==D.Alpha["#text"]&&g.push("α"),"1"==D.Beta["#text"]&&g.push("β"),g.length>0){var v="";$.each(g,function(t,e){v=0==v.length?a.code+": "+e:v+" & "+e,f.push({tp:e,date:toDate(D.fullDate["#text"]),index:r.length-1})}),d.push({value:D.fullDate["#text"],text:v})}}var y={};y.angle=s,y.gdp=r,y.gdpgc=h,y.date=o,y.dates=i,y.ser1=u,y.ser2=l,y.serie=n,y.label=d,y.region=p,y.description=a.description,y.code=a.code,y.tps=f,e[a.code]=y}DataSetLoader.prototype.loadDataSet=function(t){("string"==typeof t||t instanceof String)&&(this.file=t),this.loaded=!1,this.error=!1,this.xhttp=new XMLHttpRequest,this.xhttp.onreadystatechange=function(){4==this.xhttp.readyState&&200==this.xhttp.status?(this.loaded=!0,this.xmlDoc=this.xhttp.responseXML,this.dataSet=xmlToJson(this.xmlDoc),this.onready(this.dataSet,this.xmlDoc,this.xhttp,this.file)):200!=this.xhttp.status&&0!=this.xhttp.status&&(this.error=!0,this.onerror(this.xhttp,this.file))}.bind(this),this.xhttp.open("GET",this.file,!0),this.xhttp.send()},"function"==typeof define&&define.amd?define("dataSetLoader",["bcc_commons"],function(){return new DataSetLoader}):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=new DataSetLoader);