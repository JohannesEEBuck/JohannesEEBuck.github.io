/**
 * Suvorov Roman windj007@gmail.com (c) 2012
 * 
 */

!function(e){function t(t,i,s,n,o){this.selection=new e.jqplot.Selection,n=n||{},e.extend(!0,this.selection,{selectedMarkerOptions:n.markerOptions},{selectedMarkerOptions:{color:this.color}},s.selection,n.selection),this.selection.renderer.init.call(this.selection,null),this.selection.markerRenderer.init.call(this.selection.markerRenderer,this.selection.selectedMarkerOptions)}function i(t,i){if(i=e.extend(!0,{},this.selection,i),i.show&&this.show){var s=this.data,n=e.map(i.selectedPoints,function(e){return[s[e]]}),o=this.renderer.makeGridData.call(this,n);this.selection.renderer.draw.call(this.selection,t,o,{})}}function s(t,i,s){this.target.bind("jqplotDataClick",e.proxy(n,this)),this.togglePoint=e.proxy(o,this),this.togglePointSilently=e.proxy(l,this)}function n(e,t,i,s){this.togglePoint(t,i)}function o(e,t,i){var s=this.series[e];if(!s.selection||!s.selection.show)return!1;var n=c(e,t),o=[e,t,n];if(n){if(s.selection.onDeselect&&!s.selection.onDeselect.apply(this,o)&&!i)return n}else if(s.selection.onSelect&&!s.selection.onSelect.apply(this,o)&&!i)return n;if(n=r.call(this,e,t),o=[e,t,n],n)return s.selection.onSelected&&s.selection.onSelected.apply(this,o),this.target.trigger("jqplotPointSelected",o),!0;var o=[e,t,!1];return s.selection.onDeselected&&s.selection.onDeselected.apply(this,o),this.target.trigger("jqplotPointDeselected",o),!1}function l(e,t){var i=this.series[e];return!(!i.selection||!i.selection.show)&&r.call(this,e,t)}function r(t,i){var s=this.series[t],n=e.inArray(i,s.selection.selectedPoints);return-1==n?(s.selection.selectedPoints.push(i),this.drawSeries({},t),!0):(s.selection.selectedPoints.splice(n,1),this.drawSeries({},t),!1)}function c(t,i){if(s&&this.series.length>t){var s=this.series[t];return e.inArray(i,s.selection.selectedPoints)>=0}return!1}e.jqplot.Selection=function(){this.show=e.jqplot.config.enablePlugins,this.renderer=new e.jqplot.LineRenderer,this.rendererOptions={showLine:!1,showMarker:!0},this.markerRenderer=new e.jqplot.MarkerRenderer,this.selectedMarkerOptions={size:15},this.selectedPoints=[],this.onSelect=null,this.onDeselect=null,this.onSelected=null,this.onDeselected=null},e.jqplot.postSeriesInitHooks.push(t),e.jqplot.postDrawSeriesHooks.push(i),e.jqplot.postInitHooks.push(s)}(jQuery);