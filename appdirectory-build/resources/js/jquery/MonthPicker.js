/*
The jQuery UI Month Picker Version 3.0.0
https://github.com/KidSysco/jquery-ui-month-picker/

Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see 
<http://www.gnu.org/licenses/gpl-3.0.txt>.

*/

!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){!function(t,e,i,n){"use strict";function o(t){return t.getMonth()+12*t.getFullYear()}function s(t){return Math.floor(t/12)}function a(){t(this).addClass(g)}function r(t,e){return t[e?"on":"off"]("mousenter mouseout",a).toggleClass(g,e)}function h(t,e,i){return(!e||t>=e)&&(!i||t<=i)}function u(e,i){if(null===i)return i;if(i instanceof n)return o(i);if(t.isNumeric(i))return o(new n)+parseInt(i,10);var s=e._parseMonth(i);return s?o(s):c(i)}function l(t,e){return O(e.options[t]||C,e.element[0])}function c(e,i){var s=t.trim(e);s=s.replace(/y/i,'":"y"'),s=s.replace(/m/i,'":"m"');try{var a=JSON.parse('{"'+s.replace(/ /g,',"')+"}"),r={};for(var h in a)r[a[h]]=h;var u=o(new n);return(u+=parseInt(r.m,10)||0)+12*(parseInt(r.y,10)||0)}catch(t){return!1}}function d(e){return t('<span id="MonthPicker_Button_'+this.id+'" class="month-picker-open-button">'+e.i18n.buttonText+"</span>").jqueryUIButton({text:!1,icons:{primary:e.ButtonIcon}})}function p(t,e){t.jqueryUIButton("option",{icons:{primary:"ui-icon-circle-triangle-"+(e?"w":"e")}})}function _(t){return!t.is("input")}function f(e,i){function n(){u=setTimeout(o,175)}function o(){u=null,c=t("span",e).animate({opacity:.45},l,s)}function s(){h=c.text(),c.animate({opacity:1},l).text(i)}function a(){u?clearTimeout(u):c=t("span",e).animate({opacity:.45},l,r)}function r(){c.text(h).animate({opacity:1},l)}var h,u,l=125,c=t();e.on("mouseenter"+k+"h",n),e.on("mouseleave"+k+"h",a),e.data(b,function(){clearTimeout(u),c.stop().css({opacity:1}),e.off(k+"h")})}function m(t,e){var i=t.data("ui-button");i.option("disabled")!==e&&i.option("disabled",e)}var v="MonthPicker Error: ";if(!t)return void alert(v+"jQuery must be loaded.");if(!t.ui)return void alert(v+"jQuery UI must be loaded.");if(!(t&&t.ui&&t.ui.button&&t.ui.datepicker))return void alert(v+"The jQuery UI button and datepicker plug-ins must be loaded.");t.widget.bridge("jqueryUIButton",t.ui.button);var M=t.fx.speeds,k=".MonthPicker",b="month-picker-clear-hint",Y="ui-state-highlight",g="ui-state-active",y={my:"left top+1",at:"left bottom"},B={my:"right top+1",at:"right bottom"},x=v+"The jQuery UI position plug-in must be loaded.",w=v+"Unsupported % option value, supported values are: ",P=v+'"_" is not a valid %Month value.',I=null,T=!!t.ui.position,S={Animation:["slideToggle","fadeToggle","none"],ShowAnim:["fadeIn","slideDown","none"],HideAnim:["fadeOut","slideUp","none"]},A={ValidationErrorMessage:"_createValidationMessage",Disabled:"_setDisabledState",ShowIcon:"_updateButton",Button:"_updateButton",ShowOn:"_updateFieldEvents",IsRTL:"_setRTL",AltFormat:"_updateAlt",AltField:"_updateAlt",StartYear:"_setPickerYear",MinMonth:"_setMinMonth",MaxMonth:"_setMaxMonth",SelectedMonth:"_setSelectedMonth"},C=t.noop,O=t.proxy,D=t.datepicker,F="click"+k;t.MonthPicker={VERSION:"3.0.0",i18n:{year:"Year",prevYear:"Previous Year",nextYear:"Next Year",next12Years:"Jump Forward 12 Years",prev12Years:"Jump Back 12 Years",nextLabel:"Next",prevLabel:"Prev",buttonText:"Open Month Chooser",jumpYears:"Jump Years",backTo:"Back to",months:["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sep.","Oct.","Nov.","Dec."]}};t.widget("KidSysco.MonthPicker",{options:{i18n:{},IsRTL:!1,Position:null,StartYear:null,ShowIcon:!0,UseInputMask:!1,ValidationErrorMessage:null,Disabled:!1,MonthFormat:"mm/yy",Animation:"fadeToggle",ShowAnim:null,HideAnim:null,ShowOn:null,MinMonth:null,MaxMonth:null,Duration:"normal",Button:d,ButtonIcon:"ui-icon-calculator"},_monthPickerButton:t(),_validationMessage:t(),_selectedBtn:t(),_destroy:function(){var e=this.element;t.mask&&this.options.UseInputMask&&(e.unmask(),this.GetSelectedDate()||e.val("")),e.removeClass("month-year-input").off(k),t(i).off(k+this.uuid),this._monthPickerMenu.remove();var n=this._monthPickerButton.off(F);this._removeOldBtn&&n.remove(),this._validationMessage.remove(),I===this&&(I=null)},_setOption:function(e,i){switch(e){case"i18n":i=t.extend({},i);break;case"Position":if(!T)return void alert(x);break;case"MonthFormat":var n=this.GetSelectedDate();n&&this.element.val(this.FormatMonth(n,i))}if(e in S&&-1===t.inArray(i,S[e]))return void alert(w.replace(/%/,e)+S[e]);this._super(e,i),A[e]&&this[A[e]](i)},_create:function(){var e=this.element,o=this.options,a=e.attr("type");if(!e.is("input,div,span")||"text"!==a&&"month"!==a&&void 0!==a){var r=v+"MonthPicker can only be called on text or month inputs.";return alert(r+" \n\nSee (developer tools) for more details."),console.error(r+"\n Caused by:"),console.log(e[0]),!1}if(!t.mask&&o.UseInputMask)return alert(v+"The UseInputMask option requires the Input Mask Plugin. Get it from digitalbush.com"),!1;if(null!==o.Position&&!T)return alert(x),!1;for(var h in S)if(null!==o[h]&&-1===t.inArray(o[h],S[h]))return alert(w.replace(/%/,h)+S[h]),!1;this._isMonthInputType="month"===e.attr("type"),this._isMonthInputType&&(this.options.MonthFormat=this.MonthInputFormat,e.css("width","auto"));var l=this._monthPickerMenu=t('<div id="MonthPicker_'+e[0].id+'" class="month-picker ui-widget ui-widget-content ui-corner-all"></div>').hide(),c=_(e);t('<div class="ui-widget-header month-picker-header ui-corner-all"><table class="month-picker-year-table"><tr><td class="month-picker-previous"><a /></td><td class="month-picker-title"><a /></td><td class="month-picker-next"><a /></td></tr></table></div><div><table class="month-picker-month-table" /></div>').appendTo(l),l.appendTo(c?e:i.body),this._titleButton=t(".month-picker-title",l).click(O(this._showYearsClickHandler,this)).find("a").jqueryUIButton().removeClass("ui-state-default"),this._applyJumpYearsHint(),this._createValidationMessage(),this._prevButton=t(".month-picker-previous>a",l).jqueryUIButton({text:!1}).removeClass("ui-state-default"),this._nextButton=t(".month-picker-next>a",l).jqueryUIButton({text:!1}).removeClass("ui-state-default"),this._setRTL(o.IsRTL),t(".ui-button-icon-primary",this._nextButton).text(this._i18n("nextLabel")),t(".ui-button-icon-primary",this._prevButton).text(this._i18n("prevLabel"));for(var d=t(".month-picker-month-table",l),p=0;p<12;p++){var f=p%3?f:t("<tr />").appendTo(d);f.append('<td><a class="button-'+(p+1)+'" /></td>')}this._buttons=t("a",d).jqueryUIButton(),l.on(F,function(t){return!1});var m=this;t.each(["Min","Max"],function(t,e){m["_set"+e+"Month"]=function(t){!1===(m["_"+e+"Month"]=u(m,t))&&alert(P.replace(/%/,e).replace(/_/,t))},m._setOption(e+"Month",m.options[e+"Month"])});var M=o.SelectedMonth;if(void 0!==M){var k=u(this,M);e.val(this._formatMonth(new n(s(k),k%12,1)))}this._updateAlt(),this._setUseInputMask(),this._setDisabledState(),this.Destroy=this.destroy,c?this.Open():(e.addClass("month-year-input"),e.change(O(this._updateAlt,this)))},GetSelectedDate:function(){return this._parseMonth()},GetSelectedYear:function(){var t=this.GetSelectedDate();return t?t.getFullYear():NaN},GetSelectedMonth:function(){var t=this.GetSelectedDate();return t?t.getMonth()+1:NaN},Validate:function(){var t=this.GetSelectedDate();return null===this.options.ValidationErrorMessage||this.options.Disabled||this._validationMessage.toggle(!t),t},GetSelectedMonthYear:function(){var t=this.Validate();return t?t.getMonth()+1+"/"+t.getFullYear():null},Disable:function(){this._setOption("Disabled",!0)},Enable:function(){this._setOption("Disabled",!1)},ClearAllCallbacks:function(){for(var t in this.options)0===t.indexOf("On")&&(this.options[t]=C)},Clear:function(){this.element.val(""),this._validationMessage.hide()},Toggle:function(t){return this._visible?this.Close(t):this.Open(t)},Open:function(e){var n=this.element,o=this.options;if(!o.Disabled&&!this._visible){if(e=e||t.Event(),!1===l("OnBeforeMenuOpen",this)(e)||e.isDefaultPrevented())return!1;this._visible=!0,this._ajustYear(o);var s=this._monthPickerMenu;if(this._showMonths(),_(n))s.css("position","static").show(),l("OnAfterMenuOpen",this)();else{I&&I.Close(e),I=this,t(i).on(F+this.uuid,O(this.Close,this)).on("keydown"+k+this.uuid,O(this._keyDown,this)),n.off("blur"+k).focus();var a=o.ShowAnim||o.Animation,r="none"===a;s[r?"fadeIn":a]({duration:r?0:this._duration(),start:O(this._position,this,s),complete:l("OnAfterMenuOpen",this)})}}return!1},Close:function(e){var n=this.element;if(!_(n)&&this._visible){var o=this._monthPickerMenu,s=this.options;if(e=e||t.Event(),!1===l("OnBeforeMenuClose",this)(e)||e.isDefaultPrevented())return;this._backToYear&&(this._applyJumpYearsHint(),this._backToYear=0),this._visible=!1,I=null,t(i).off("keydown"+k+this.uuid).off(F+this.uuid),this.Validate(),n.on("blur"+k,O(this.Validate,this));var a=l("OnAfterMenuClose",this),r=s.HideAnim||s.Animation;"none"===r?o.hide(0,a):o[r](this._duration(),a)}},SetSelectedMonth:function(t){this._setSelectedMonth(t)},MonthInputFormat:"yy-mm",ParseMonth:function(t,e){try{return D.parseDate("dd"+e,"01"+t)}catch(t){return null}},FormatMonth:function(t,e){try{return D.formatDate(e,t)||null}catch(t){return null}},_setSelectedMonth:function(t){var e=u(this,t),i=this.element;e?i.val(this._formatMonth(new n(s(e),e%12,1))):i.val(""),this._ajustYear(this.options),this._showMonths()},_applyJumpYearsHint:function(){f(this._titleButton,this._i18n("jumpYears"))},_i18n:function(e){return this.options.i18n[e]||t.MonthPicker.i18n[e]},_parseMonth:function(t,e){return this.ParseMonth(t||this.element.val(),e||this.options.MonthFormat)},_formatMonth:function(t,e){return this.FormatMonth(t||this._parseMonth(),e||this.options.MonthFormat)},_updateButton:function(){var t=this.options.Disabled;this._createButton();var e=this._monthPickerButton;try{e.jqueryUIButton("option","disabled",t)}catch(i){e.filter("button,input").prop("disabled",t)}this._updateFieldEvents()},_createButton:function(){var e=this.element,n=this.options;if(!_(e)){var o=this._monthPickerButton.off(k),s=!!n.ShowIcon&&n.Button;if(t.isFunction(s)){var a=t.extend(!0,{i18n:t.extend(!0,{},t.MonthPicker.i18n)},this.options);s=s.call(e[0],a)}var r=!1;this._monthPickerButton=(s instanceof t?s:t(s)).each(function(){t.contains(i.body,this)||(r=!0,t(this).insertAfter(e))}).on(F,O(this.Toggle,this)),this._removeOldBtn&&o.remove(),this._removeOldBtn=r}},_updateFieldEvents:function(){var t=F+" focus"+k;this.element.off(t),"both"!==this.options.ShowOn&&this._monthPickerButton.length||this.element.on(t,O(this.Open,this))},_createValidationMessage:function(){var e=this.options.ValidationErrorMessage,i=this.element;if(-1===t.inArray(e,[null,""])){var n=t('<span id="MonthPicker_Validation_'+i[0].id+'" class="month-picker-invalid-message">'+e+"</span>"),o=this._monthPickerButton;this._validationMessage=n.insertAfter(o.length?o:i),i.on("blur"+k,O(this.Validate,this))}else this._validationMessage.remove()},_setRTL:function(t){p(this._prevButton.css("float",t?"right":"left"),!t),p(this._nextButton.css("float",t?"left":"right"),t)},_keyDown:function(t){switch(t.keyCode){case 13:this.element.val()||this._chooseMonth((new n).getMonth()+1),this.Close(t);break;case 27:case 9:this.Close(t)}},_duration:function(){var e=this.options.Duration;return t.isNumeric(e)?e:e in M?M[e]:M._default},_position:T?function(e){var i=this.options.IsRTL?B:y,n=t.extend(i,this.options.Position);return e.position(t.extend({of:this.element},n))}:function(t){var e=this.element,i={top:e.offset().top+e.height()+7+"px"};return this.options.IsRTL?i.left=e.offset().left-t.width()+e.width()+7+"px":i.left=e.offset().left+"px",t.css(i)},_setUseInputMask:function(){if(!this._isMonthInputType)try{this.options.UseInputMask?this.element.mask(this._formatMonth(new n).replace(/\d/g,9)):this.element.unmask()}catch(t){}},_setDisabledState:function(){var t=this.options.Disabled,e=this.element;e[0].disabled=t,e.toggleClass("month-picker-disabled",t),t&&this._validationMessage.hide(),this.Close(),this._updateButton(),l("OnAfterSetDisabled",this)(t)},_getPickerYear:function(){return this._pickerYear},_setPickerYear:function(t){this._pickerYear=t||(new n).getFullYear(),this._titleButton.jqueryUIButton({label:this._i18n("year")+" "+this._pickerYear})},_updateAlt:function(e,i){var n=t(this.options.AltField);n.length&&n.val(this._formatMonth(i,this.options.AltFormat))},_chooseMonth:function(e){var i=this._getPickerYear(),o=new n(i,e-1);this.element.val(this._formatMonth(o)).blur(),this._updateAlt(0,o),r(this._selectedBtn,!1),this._selectedBtn=r(t(this._buttons[e-1]),!0),l("OnAfterChooseMonth",this)(o)},_chooseYear:function(t){this._backToYear=0,this._setPickerYear(t),this._buttons.removeClass(Y),this._showMonths(),this._applyJumpYearsHint(),l("OnAfterChooseYear",this)()},_showMonths:function(){var e=this._i18n("months");this._prevButton.attr("title",this._i18n("prevYear")).off(F).on(F,O(this._addToYear,this,-1)),this._nextButton.attr("title",this._i18n("nextYear")).off(F).on(F,O(this._addToYear,this,1)),this._buttons.off(k);var i=this,n=O(i._onMonthClick,i);t.each(e,function(e,o){t(i._buttons[e]).on(F,{month:e+1},n).jqueryUIButton("option","label",o)}),this._decorateButtons()},_showYearsClickHandler:function(){if(this._buttons.removeClass(Y),this._backToYear)this._setPickerYear(this._backToYear),this._applyJumpYearsHint(),this._showMonths(),this._backToYear=0;else{this._backToYear=this._getPickerYear(),this._showYears();var t=this._i18n("backTo")+" "+this._getPickerYear();this._titleButton.jqueryUIButton({label:t}).data(b)(),l("OnAfterChooseYears",this)()}},_showYears:function(){var e=this._getPickerYear(),i=-4,o=e+i,a=(new n).getFullYear(),u=this._MinMonth,l=this._MaxMonth,c=u?s(u):0,d=l?s(l):0;this._prevButton.attr("title",this._i18n("prev12Years")).off(F).on(F,O(this._addToYears,this,-12)),this._nextButton.attr("title",this._i18n("next12Years")).off(F).on(F,O(this._addToYears,this,12)),m(this._prevButton,c&&o-1<c),m(this._nextButton,d&&o+12-1>d),this._buttons.off(k),r(this._selectedBtn,!1);for(var p=this.GetSelectedYear(),_=O(this._onYearClick,this),f=h(a,c,d),v=h(p,c,d),M=0;M<12;M++){var b=e+i,g=t(this._buttons[M]).jqueryUIButton({disabled:!h(b,c,d),label:b}).toggleClass(Y,b===a&&f).on(F,{year:b},_);v&&p&&p===b&&(this._selectedBtn=r(g,!0)),i++}},_onMonthClick:function(t){this._chooseMonth(t.data.month),this.Close(t)},_onYearClick:function(t){this._chooseYear(t.data.year)},_addToYear:function(t){this._setPickerYear(this._getPickerYear()+t),this.element.focus(),this._decorateButtons(),l("OnAfter"+(t>0?"Next":"Previous")+"Year",this)()},_addToYears:function(t){this._pickerYear=this._getPickerYear()+t,this._showYears(),this.element.focus(),l("OnAfter"+(t>0?"Next":"Previous")+"Years",this)()},_ajustYear:function(t){var e=t.StartYear||this.GetSelectedYear()||(new n).getFullYear();null!==this._MinMonth&&(e=Math.max(s(this._MinMonth),e)),null!==this._MaxMonth&&(e=Math.min(s(this._MaxMonth),e)),this._setPickerYear(e)},_decorateButtons:function(){var e=this._getPickerYear(),i=o(new n),a=this._MinMonth,u=this._MaxMonth;r(this._selectedBtn,!1);var l=this.GetSelectedDate(),c=h(l?o(l):null,a,u);l&&l.getFullYear()===e&&(this._selectedBtn=r(t(this._buttons[l.getMonth()]),c)),m(this._prevButton,a&&e==s(a)),m(this._nextButton,u&&e==s(u));for(var d=0;d<12;d++){var p=12*e+d,_=h(p,a,u);t(this._buttons[d]).jqueryUIButton({disabled:!_}).toggleClass(Y,_&&p==i)}}})}(jQuery,window,document,Date)});