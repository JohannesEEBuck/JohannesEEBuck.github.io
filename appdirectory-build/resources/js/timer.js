function TimerLoop(e,t,i,s,r,a,o){if(this.loop=!1,this.started=!1,this.hiddenPause=!1,this.fast=!1,this.selector=t,this.backward=!!a,this.isPaused=!!r,this.interval=null,this.onPosChange=e,this.minTimerPos=i,this.maxTimerPos=s,this.timerPos=o?this.maxTimerPos:this.minTimerPos,r||this.goForward(!0),visProp=this.getHiddenProp(),visProp){var l=visProp.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(l,this.visChange.bind(this))}$(t).children(".playerControl").length<=0&&this.addPlayer()}"function"==typeof define&&define.amd?define("timer",["jquery"],function(e){return TimerLoop}):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=TimerLoop),TimerLoop.prototype.play=function(e){void 0===e&&(e=this.fast),this.isPaused&&this.timerPos==this.maxTimerPos&&this.setPos(this.minTimerPos),this.isPaused=!1,this.started||(this.started=!0),this.interval&&e!=this.fast&&(clearInterval(this.interval),this.interval=null),this.interval||(this.fast=e,this.interval=setInterval(function(){!0!==this.hiddenPause&&this.setPos(this.timerPos+(this.backward?-1:1))}.bind(this),this.fast?100:400)),$(this.selector).find(".playerControl.selectable").removeClass("selected"),this.backward?$(this.selector).find(e?".playerControl.fastbackward":".playerControl.backward").addClass("selected"):$(this.selector).find(e?".playerControl.fastforward":".playerControl.play").addClass("selected")},TimerLoop.prototype.pause=function(){this.isPaused=!0,clearInterval(this.interval),this.interval=null,$(this.selector).find(".playerControl.selectable").removeClass("selected"),$(this.selector).find(".playerControl.pause").addClass("selected")},TimerLoop.prototype.goForward=function(e,t){this.started||(this.timerPos=-1),this.backward=!1,e&&this.play(void 0!=t&&t),$(this.selector).find(".playerControl.selectable").removeClass("selected"),$(this.selector).find(t?".playerControl.fastforward":".playerControl.play").addClass("selected")},TimerLoop.prototype.goBackward=function(e,t){this.backward=!0,e&&this.play(void 0!=t&&t),$(this.selector).find(".playerControl.selectable").removeClass("selected"),$(this.selector).find(t?".playerControl.fastbackward":".playerControl.backward").addClass("selected")},TimerLoop.prototype.setPos=function(e,t){if("number"==typeof e&&isFinite(e)){e=Math.round(e),this.started=!0;var i=e>=this.timerPos;(e>this.maxTimerPos||e<this.minTimerPos)&&(e=t?i?this.maxTimerPos:this.minTimerPos:i?this.minTimerPos:this.maxTimerPos);this.onPosChange(e,this);this.timerPos=e,this.loop||this.timerPos!=this.maxTimerPos||this.pause()}},TimerLoop.prototype.backToStart=function(){this.setPos(this.minTimerPos)},TimerLoop.prototype.goToEnd=function(){this.setPos(this.maxTimerPos)},TimerLoop.prototype.next=function(e){"number"==typeof e&&isFinite(e)?this.setPos(this.timerPos+e,!0):this.setPos(this.timerPos+1,!0)},TimerLoop.prototype.back=function(e){"number"==typeof e&&isFinite(e)?this.setPos(this.timerPos-e,!0):this.setPos(this.timerPos-1,!0)},TimerLoop.prototype.getHiddenProp=function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";if("Hidden"in document)return"Hidden";for(var t=0;t<e.length;t++){if(e[t]+"hidden"in document)return e[t]+"hidden";if(e[t]+"Hidden"in document)return e[t]+"Hidden"}return null},TimerLoop.prototype.isPageHidden=function(){var e=this.getHiddenProp();return!!e&&document[e]},TimerLoop.prototype.visChange=function(){this.isPageHidden()?this.isPaused||(this.hiddenPause=!0,this.pause()):this.hiddenPause&&(this.hiddenPause=!1,this.play())},TimerLoop.prototype.addPlayer=function(e){this.player=$(this.selector),this.player.hasClass("timerPlyer")||this.player.addClass("timerPlayer"),this.player.append('<div class="playerControl pause selectable" alt="pause" title="Pause"/>'),this.player.append('<div class="playerControl play selectable" alt="play" title="Play"/>'),this.player=$(this.player),this.player.children(".playerControl.pause").click(function(){this.pause()}.bind(this)),this.player.children(".playerControl.play").click(function(){this.goForward(!0)}.bind(this)),e&&(this.player.append('<img class="playerControl extended fastbackward hover-highlight selectable" src="resources/img/button_black_fast_backward.gif" alt="fast backward" title="Fast backward" />'),this.player.append('<img class="playerControl extended backward hover-highlight selectable" src="resources/img/button_black_play_back.gif" alt="play backward" title="Play backward" />'),this.player.append('<img class="playerControl extended fastforward hover-highlight selectable" src="resources/img/button_black_fast_forward.gif" alt="fast forward" title="Fast forward" />'),this.player.children(".playerControl.fastbackward").click(function(){this.goBackward(!0,!0)}.bind(this)),this.player.children(".playerControl.backward").click(function(){this.goBackward(!0)}.bind(this)),this.player.children(".playerControl.fastforward").click(function(){this.goForward(!0,!0)}.bind(this))),this.isPaused?this.player.children(".playerControl.pause").addClass("selected"):this.player.children(".playerControl.play").addClass("selected")};